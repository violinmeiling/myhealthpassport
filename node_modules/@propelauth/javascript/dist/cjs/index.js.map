{"version":3,"file":"index.js","sources":["../../node_modules/js-cookie/dist/js.cookie.mjs","../../src/cookies.ts","../../src/org.ts","../../src/access_helper.ts","../../src/org_helper.ts","../../src/user.ts","../../src/api.ts","../../src/fetch_retries.ts","../../src/helpers.ts","../../src/client.ts"],"sourcesContent":["/*! js-cookie v3.0.5 | MIT */\n/* eslint-disable no-var */\nfunction assign (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      target[key] = source[key];\n    }\n  }\n  return target\n}\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\nvar defaultConverter = {\n  read: function (value) {\n    if (value[0] === '\"') {\n      value = value.slice(1, -1);\n    }\n    return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n  },\n  write: function (value) {\n    return encodeURIComponent(value).replace(\n      /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n      decodeURIComponent\n    )\n  }\n};\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\n\nfunction init (converter, defaultAttributes) {\n  function set (name, value, attributes) {\n    if (typeof document === 'undefined') {\n      return\n    }\n\n    attributes = assign({}, defaultAttributes, attributes);\n\n    if (typeof attributes.expires === 'number') {\n      attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n    }\n    if (attributes.expires) {\n      attributes.expires = attributes.expires.toUTCString();\n    }\n\n    name = encodeURIComponent(name)\n      .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n      .replace(/[()]/g, escape);\n\n    var stringifiedAttributes = '';\n    for (var attributeName in attributes) {\n      if (!attributes[attributeName]) {\n        continue\n      }\n\n      stringifiedAttributes += '; ' + attributeName;\n\n      if (attributes[attributeName] === true) {\n        continue\n      }\n\n      // Considers RFC 6265 section 5.2:\n      // ...\n      // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n      //     character:\n      // Consume the characters of the unparsed-attributes up to,\n      // not including, the first %x3B (\";\") character.\n      // ...\n      stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n    }\n\n    return (document.cookie =\n      name + '=' + converter.write(value, name) + stringifiedAttributes)\n  }\n\n  function get (name) {\n    if (typeof document === 'undefined' || (arguments.length && !name)) {\n      return\n    }\n\n    // To prevent the for loop in the first place assign an empty array\n    // in case there are no cookies at all.\n    var cookies = document.cookie ? document.cookie.split('; ') : [];\n    var jar = {};\n    for (var i = 0; i < cookies.length; i++) {\n      var parts = cookies[i].split('=');\n      var value = parts.slice(1).join('=');\n\n      try {\n        var found = decodeURIComponent(parts[0]);\n        jar[found] = converter.read(value, found);\n\n        if (name === found) {\n          break\n        }\n      } catch (e) {}\n    }\n\n    return name ? jar[name] : jar\n  }\n\n  return Object.create(\n    {\n      set,\n      get,\n      remove: function (name, attributes) {\n        set(\n          name,\n          '',\n          assign({}, attributes, {\n            expires: -1\n          })\n        );\n      },\n      withAttributes: function (attributes) {\n        return init(this.converter, assign({}, this.attributes, attributes))\n      },\n      withConverter: function (converter) {\n        return init(assign({}, this.converter, converter), this.attributes)\n      }\n    },\n    {\n      attributes: { value: Object.freeze(defaultAttributes) },\n      converter: { value: Object.freeze(converter) }\n    }\n  )\n}\n\nvar api = init(defaultConverter, { path: '/' });\n/* eslint-enable no-var */\n\nexport { api as default };\n","export const ACTIVE_ORG_ID_COOKIE_NAME = \"active_org_id\"\n","import Cookies from \"js-cookie\"\nimport { ACTIVE_ORG_ID_COOKIE_NAME } from \"./cookies\"\n\nexport type OrgMemberInfo = {\n    orgId: string\n    orgName: string\n    orgMetadata: { [key: string]: any }\n    urlSafeOrgName: string\n    orgRoleStructure: OrgRoleStructure\n    userAssignedRole: string\n    userInheritedRolesPlusCurrentRole: string[]\n    userPermissions: string[]\n    userAssignedAdditionalRoles: string[]\n}\nexport type OrgIdToOrgMemberInfo = {\n    [orgId: string]: OrgMemberInfo\n}\n\nexport enum OrgRoleStructure {\n    SingleRole = \"single_role_in_hierarchy\",\n    MultiRole = \"multi_role\",\n}\n\nexport const setActiveOrgId = (orgId: string) => {\n    Cookies.set(ACTIVE_ORG_ID_COOKIE_NAME, orgId, {\n        sameSite: \"lax\",\n        secure: true,\n    })\n}\n\nexport const getActiveOrgId = (): string | undefined => {\n    return Cookies.get(ACTIVE_ORG_ID_COOKIE_NAME)\n}\n","import {OrgIdToOrgMemberInfo, OrgRoleStructure} from \"./org\";\n\nexport type AccessHelper = {\n    isRole: (orgId: string, role: string) => boolean\n    isAtLeastRole: (orgId: string, role: string) => boolean\n    hasPermission: (orgId: string, permission: string) => boolean\n    hasAllPermissions: (orgId: string, permissions: string[]) => boolean\n    getAccessHelperWithOrgId: (orgId: string) => AccessHelperWithOrg\n}\n\nexport type AccessHelperWithOrg = {\n    isRole: (role: string) => boolean\n    isAtLeastRole: (role: string) => boolean\n    hasPermission: (permission: string) => boolean\n    hasAllPermissions: (permissions: string[]) => boolean\n}\n\nexport function getAccessHelper(\n    orgIdToOrgMemberInfo: OrgIdToOrgMemberInfo,\n): AccessHelper {\n    function isRole(orgId: string, role: string): boolean {\n        const orgMemberInfo = orgIdToOrgMemberInfo[orgId]\n        if (orgMemberInfo === undefined) {\n            return false;\n        }\n        if (orgMemberInfo.orgRoleStructure === OrgRoleStructure.MultiRole) {\n            return orgMemberInfo.userAssignedRole === role || orgMemberInfo.userAssignedAdditionalRoles.includes(role)\n        } else {\n            return orgMemberInfo.userAssignedRole === role\n        }\n    }\n    \n    function isAtLeastRole(orgId: string, role: string): boolean {\n        const orgMemberInfo = orgIdToOrgMemberInfo[orgId]\n        if (orgMemberInfo === undefined) {\n            return false;\n        }\n        if (orgMemberInfo.orgRoleStructure === OrgRoleStructure.MultiRole) {\n            return orgMemberInfo.userAssignedRole === role || orgMemberInfo.userAssignedAdditionalRoles.includes(role)\n        } else {\n            return orgMemberInfo.userInheritedRolesPlusCurrentRole.includes(role)\n        }\n    }\n\n    function hasPermission(orgId: string, permission: string): boolean {\n        const orgMemberInfo = orgIdToOrgMemberInfo[orgId]\n        if (orgMemberInfo === undefined) {\n            return false;\n        }\n        return orgMemberInfo.userPermissions.includes(permission)\n    }\n\n    function hasAllPermissions(orgId: string, permissions: string[]): boolean {\n        const orgMemberInfo = orgIdToOrgMemberInfo[orgId]\n        if (orgMemberInfo === undefined) {\n            return false;\n        }\n        return permissions.every(permission => orgMemberInfo.userPermissions.includes(permission))\n    }\n\n    function getAccessHelperWithOrgId(orgId: string): AccessHelperWithOrg {\n        return {\n            isRole(role: string): boolean {\n                return isRole(orgId, role)\n            },\n            isAtLeastRole(role: string): boolean {\n                return isAtLeastRole(orgId, role)\n            },\n            hasPermission(permission: string): boolean {\n                return hasPermission(orgId, permission)\n            },\n            hasAllPermissions(permissions: string[]): boolean {\n                return hasAllPermissions(orgId, permissions)\n            },\n        }\n    }\n    \n    return {\n        isRole,\n        isAtLeastRole,\n        hasPermission,\n        hasAllPermissions,\n        getAccessHelperWithOrgId,\n    }\n}\n","import {OrgIdToOrgMemberInfo, OrgMemberInfo} from \"./org\";\n\nexport type OrgHelper = {\n    getOrgs: () => OrgMemberInfo[]\n    getOrgIds: () => string[]\n    getOrg: (orgId: string) => OrgMemberInfo | undefined\n    getOrgByName: (orgName: string) => OrgMemberInfo | undefined\n}\n\nexport function getOrgHelper(\n    orgIdToOrgMemberInfo: OrgIdToOrgMemberInfo,\n): OrgHelper {\n    return {\n        getOrg(orgId: string): OrgMemberInfo | undefined {\n            if (orgIdToOrgMemberInfo.hasOwnProperty(orgId)) {\n                return orgIdToOrgMemberInfo[orgId]\n            } else {\n                return undefined\n            }\n        },\n        getOrgIds(): string[] {\n            return Object.keys(orgIdToOrgMemberInfo)\n        },\n        getOrgs(): OrgMemberInfo[] {\n            return Object.values(orgIdToOrgMemberInfo)\n        },\n        getOrgByName(orgName: string): OrgMemberInfo | undefined {\n            for (const orgMemberInfo of Object.values(orgIdToOrgMemberInfo)) {\n                if (orgMemberInfo.orgName === orgName || orgMemberInfo.urlSafeOrgName === orgName) {\n                    return orgMemberInfo\n                }\n            }\n            return undefined\n        },\n    }\n}","import { OrgIdToOrgMemberInfo, OrgRoleStructure } from \"./org\"\n\nexport type UserProperties = { [key: string]: unknown }\n\nexport interface UserFields {\n    userId: string\n    email: string\n    createdAt: number\n    firstName?: string\n    lastName?: string\n    username?: string\n    properties?: UserProperties\n    pictureUrl?: string\n    hasPassword?: boolean\n    hasMfaEnabled?: boolean\n    canCreateOrgs?: boolean\n    legacyUserId?: string\n    impersonatorUserId?: string\n}\n\nexport class UserClass {\n    public userId: string\n    public orgIdToUserOrgInfo?: OrgIdToOrgMemberInfoClass\n\n    // Metadata about the user\n    public email: string\n    public createdAt: number\n    public firstName?: string\n    public lastName?: string\n    public username?: string\n    public properties?: UserProperties\n    public pictureUrl?: string\n    public hasPassword?: boolean\n    public hasMfaEnabled?: boolean\n    public canCreateOrgs?: boolean\n\n    // If you used our migration APIs to migrate this user from a different system,\n    // this is their original ID from that system.\n    public legacyUserId?: string\n    public impersonatorUserId?: string\n\n    constructor(userFields: UserFields, orgIdToUserOrgInfo?: OrgIdToOrgMemberInfoClass) {\n        this.userId = userFields.userId\n        this.orgIdToUserOrgInfo = orgIdToUserOrgInfo\n\n        this.email = userFields.email\n        this.firstName = userFields.firstName\n        this.lastName = userFields.lastName\n        this.username = userFields.username\n        this.createdAt = userFields.createdAt\n        this.pictureUrl = userFields.pictureUrl\n        this.hasPassword = userFields.hasPassword\n        this.hasMfaEnabled = userFields.hasMfaEnabled\n        this.canCreateOrgs = userFields.canCreateOrgs\n\n        this.legacyUserId = userFields.legacyUserId\n        this.impersonatorUserId = userFields.impersonatorUserId\n        this.properties = userFields.properties\n    }\n\n    public getOrg(orgId: string): OrgMemberInfoClass | undefined {\n        if (!this.orgIdToUserOrgInfo) {\n            return undefined\n        }\n\n        return this.orgIdToUserOrgInfo[orgId]\n    }\n\n    public getOrgByName(orgName: string): OrgMemberInfoClass | undefined {\n        if (!this.orgIdToUserOrgInfo) {\n            return undefined\n        }\n\n        const urlSafeOrgName = orgName.toLowerCase().replace(/ /g, \"-\")\n        for (const orgId in this.orgIdToUserOrgInfo) {\n            const orgMemberInfo = this.orgIdToUserOrgInfo[orgId]\n            if (orgMemberInfo?.urlSafeOrgName === urlSafeOrgName) {\n                return orgMemberInfo\n            }\n        }\n\n        return undefined\n    }\n\n    public getUserProperty(key: string): unknown | undefined {\n        if (!this.properties) {\n            return undefined\n        }\n\n        return this.properties[key]\n    }\n\n    public getOrgs(): OrgMemberInfoClass[] {\n        if (!this.orgIdToUserOrgInfo) {\n            return []\n        }\n\n        return Object.values(this.orgIdToUserOrgInfo)\n    }\n\n    public isImpersonating(): boolean {\n        return !!this.impersonatorUserId\n    }\n\n    public isRole(orgId: string, role: string): boolean {\n        const orgMemberInfo = this.getOrg(orgId)\n        if (!orgMemberInfo) {\n            return false\n        }\n\n        return orgMemberInfo.isRole(role)\n    }\n\n    public isAtLeastRole(orgId: string, role: string): boolean {\n        const orgMemberInfo = this.getOrg(orgId)\n        if (!orgMemberInfo) {\n            return false\n        }\n\n        return orgMemberInfo.isAtLeastRole(role)\n    }\n\n    public hasPermission(orgId: string, permission: string): boolean {\n        const orgMemberInfo = this.getOrg(orgId)\n        if (!orgMemberInfo) {\n            return false\n        }\n\n        return orgMemberInfo.hasPermission(permission)\n    }\n\n    public hasAllPermissions(orgId: string, permissions: string[]): boolean {\n        const orgMemberInfo = this.getOrg(orgId)\n        if (!orgMemberInfo) {\n            return false\n        }\n\n        return orgMemberInfo.hasAllPermissions(permissions)\n    }\n\n    public static fromJSON(json: string): UserClass {\n        const obj = JSON.parse(json)\n        const orgIdToUserOrgInfo: OrgIdToOrgMemberInfoClass = {}\n        for (const orgId in obj.orgIdToUserOrgInfo) {\n            orgIdToUserOrgInfo[orgId] = OrgMemberInfoClass.fromJSON(JSON.stringify(obj.orgIdToUserOrgInfo[orgId]))\n        }\n        try {\n            return new UserClass(\n                {\n                    userId: obj.userId,\n                    email: obj.email,\n                    createdAt: obj.createdAt,\n                    firstName: obj.firstName,\n                    lastName: obj.lastName,\n                    username: obj.username,\n                    legacyUserId: obj.legacyUserId,\n                    impersonatorUserId: obj.impersonatorUserId,\n                    properties: obj.properties,\n                    pictureUrl: obj.pictureUrl,\n                    hasPassword: obj.hasPassword,\n                    hasMfaEnabled: obj.hasMfaEnabled,\n                    canCreateOrgs: obj.canCreateOrgs,\n                },\n                orgIdToUserOrgInfo\n            )\n        } catch (e) {\n            console.error(\"Unable to parse User. Make sure the JSON string is a stringified `UserClass` type.\", e)\n            throw e\n        }\n    }\n}\n\nexport interface OrgIdToOrgMemberInfoClass {\n    [orgId: string]: OrgMemberInfoClass\n}\n\nexport class OrgMemberInfoClass {\n    public orgId: string\n    public orgName: string\n    public orgMetadata: { [key: string]: any }\n    public urlSafeOrgName: string\n    public orgRoleStructure: OrgRoleStructure\n\n    public userAssignedRole: string\n    public userInheritedRolesPlusCurrentRole: string[]\n    public userPermissions: string[]\n    public userAssignedAdditionalRoles: string[]\n\n    constructor(\n        orgId: string,\n        orgName: string,\n        orgMetadata: { [key: string]: any },\n        urlSafeOrgName: string,\n        userAssignedRole: string,\n        userInheritedRolesPlusCurrentRole: string[],\n        userPermissions: string[],\n        orgRoleStructure?: OrgRoleStructure,\n        userAssignedAdditionalRoles?: string[]\n    ) {\n        this.orgId = orgId\n        this.orgName = orgName\n        this.orgMetadata = orgMetadata\n        this.urlSafeOrgName = urlSafeOrgName\n        this.orgRoleStructure = orgRoleStructure ?? OrgRoleStructure.SingleRole\n\n        this.userAssignedRole = userAssignedRole\n        this.userInheritedRolesPlusCurrentRole = userInheritedRolesPlusCurrentRole\n        this.userPermissions = userPermissions\n        this.userAssignedAdditionalRoles = userAssignedAdditionalRoles ?? []\n    }\n\n    // validation methods\n    public isRole(role: string): boolean {\n        if (this.orgRoleStructure === OrgRoleStructure.MultiRole) {\n            return this.userAssignedRole === role || this.userAssignedAdditionalRoles.includes(role)\n        } else {\n            return this.userAssignedRole === role\n        }\n    }\n\n    public isAtLeastRole(role: string): boolean {\n        if (this.orgRoleStructure === OrgRoleStructure.MultiRole) {\n            return this.userAssignedRole === role || this.userAssignedAdditionalRoles.includes(role)\n        } else {\n            return this.userInheritedRolesPlusCurrentRole.includes(role)\n        }\n    }\n\n    public hasPermission(permission: string): boolean {\n        return this.userPermissions.includes(permission)\n    }\n\n    public hasAllPermissions(permissions: string[]): boolean {\n        return permissions.every((permission) => this.hasPermission(permission))\n    }\n\n    public static fromJSON(json: string): OrgMemberInfoClass {\n        const obj = JSON.parse(json)\n        try {\n            return new OrgMemberInfoClass(\n                obj.orgId,\n                obj.orgName,\n                obj.orgMetadata,\n                obj.urlSafeOrgName,\n                obj.userAssignedRole,\n                obj.userInheritedRolesPlusCurrentRole,\n                obj.userPermissions,\n                obj.orgRoleStructure,\n                obj.userAssignedAdditionalRoles\n            )\n        } catch (e) {\n            console.error(\n                \"Unable to parse UserOrgInfo. Make sure the JSON string is a stringified `UserOrgInfo` type.\",\n                e\n            )\n            throw e\n        }\n    }\n}\n\nexport function convertOrgIdToOrgMemberInfo(\n    orgIdToOrgMemberInfo: OrgIdToOrgMemberInfo | undefined\n): OrgIdToOrgMemberInfoClass | undefined {\n    if (orgIdToOrgMemberInfo === undefined) {\n        return undefined\n    }\n    const orgIdToUserOrgInfo: OrgIdToOrgMemberInfoClass = {}\n    for (const orgMemberInfo of Object.values(orgIdToOrgMemberInfo)) {\n        orgIdToUserOrgInfo[orgMemberInfo.orgId] = new OrgMemberInfoClass(\n            orgMemberInfo.orgId,\n            orgMemberInfo.orgName,\n            orgMemberInfo.orgMetadata,\n            orgMemberInfo.urlSafeOrgName,\n            orgMemberInfo.userAssignedRole,\n            orgMemberInfo.userInheritedRolesPlusCurrentRole,\n            orgMemberInfo.userPermissions,\n            orgMemberInfo.orgRoleStructure,\n            orgMemberInfo.userAssignedAdditionalRoles\n        )\n    }\n    return orgIdToUserOrgInfo\n}\n","import { AccessHelper, getAccessHelper } from \"./access_helper\"\nimport { OrgIdToOrgMemberInfo } from \"./org\"\nimport { getOrgHelper, OrgHelper } from \"./org_helper\"\nimport { convertOrgIdToOrgMemberInfo, UserClass } from \"./user\"\n\nexport type User = {\n    userId: string\n\n    email: string\n    emailConfirmed: boolean\n\n    hasPassword: boolean\n\n    username?: string\n    firstName?: string\n    lastName?: string\n    pictureUrl?: string\n\n    locked: boolean\n    enabled: boolean\n    mfaEnabled: boolean\n    canCreateOrgs: boolean\n\n    createdAt: number\n    lastActiveAt: number\n\n    legacyUserId?: string\n    properties?: { [key: string]: unknown }\n}\n\nexport type AuthenticationInfo = {\n    accessToken: string\n    expiresAtSeconds: number\n    orgHelper: OrgHelper\n    accessHelper: AccessHelper\n\n    /**\n     * You should prefer orgHelper to orgIdToOrgMemberInfo.\n     * orgHelper provides useful abstractions over this mapping\n     */\n    orgIdToOrgMemberInfo?: OrgIdToOrgMemberInfo\n    user: User\n    userClass: UserClass\n\n    // If someone on your team is impersonating another user, this will be set to the employee's ID\n    // By default, user impersonation is turned off and this will be undefined\n    impersonatorUserId?: string\n}\n\nexport type LogoutResponse = {\n    redirect_to: string\n}\n\nexport function fetchAuthenticationInfo(authUrl: string, activeOrgId?: string): Promise<AuthenticationInfo | null> {\n    const queryParams = new URLSearchParams()\n    if (activeOrgId) {\n        queryParams.append(\"active_org_id\", activeOrgId)\n    }\n    let path = `${authUrl}/api/v1/refresh_token`\n    if (queryParams.toString()) {\n        path += `?${queryParams.toString()}`\n    }\n    return fetch(path, {\n        method: \"GET\",\n        credentials: \"include\",\n        headers: {\n            \"Content-Type\": \"application/json\",\n        },\n    }).then((res) => {\n        if (res.status === 401) {\n            return null\n        } else if (res.status === 0) {\n            logCorsError()\n            return Promise.reject({\n                status: 503,\n                message: \"Unable to process authentication response\",\n            })\n        } else if (!res.ok) {\n            return Promise.reject({\n                status: res.status,\n                message: res.statusText,\n            })\n        } else {\n            return parseResponse(res)\n        }\n    })\n}\n\nexport function logout(authUrl: string): Promise<LogoutResponse> {\n    return fetch(`${authUrl}/api/v1/logout`, {\n        method: \"POST\",\n        credentials: \"include\",\n        headers: {\n            \"Content-Type\": \"application/json\",\n        },\n    }).then((res) => {\n        if (res.status === 0) {\n            logCorsError()\n            return Promise.reject({\n                status: 503,\n                message: \"Unable to process authentication response\",\n            })\n        } else if (!res.ok) {\n            console.error(\"Logout error\", res.status, res.statusText)\n            return Promise.reject({\n                status: res.status,\n                message: res.statusText,\n            })\n        } else {\n            return res.json()\n        }\n    })\n}\n\nfunction parseResponse(res: Response): Promise<AuthenticationInfo> {\n    return res.text().then(\n        (httpResponse) => {\n            try {\n                const authInfoWithoutUserClass = parseJsonConvertingSnakeToCamel(httpResponse)\n                return withExtraArgs(authInfoWithoutUserClass)\n            } catch (e) {\n                console.error(\"Unable to process authentication response\", e)\n                return Promise.reject({\n                    status: 500,\n                    message: \"Unable to process authentication response\",\n                })\n            }\n        },\n        (e) => {\n            console.error(\"Unable to process authentication response\", e)\n            return Promise.reject({\n                status: 500,\n                message: \"Unable to process authentication response\",\n            })\n        }\n    )\n}\n\n// The API responds with snake_case, but TypeScript convention is camelCase.\n// When parsing JSON, we pass in reviver function to convert from snake_case to camelCase.\nexport function parseJsonConvertingSnakeToCamel(str: string): AuthenticationInfo {\n    return JSON.parse(str, function (key, value) {\n        if (key === \"org_id\") {\n            this.orgId = value\n        } else if (key === \"org_name\") {\n            this.orgName = value\n        } else if (key === \"org_metadata\") {\n            this.orgMetadata = value\n        } else if (key === \"url_safe_org_name\") {\n            this.urlSafeOrgName = value\n        } else if (key === \"user_role\") {\n            this.userAssignedRole = value\n        } else if (key === \"inherited_user_roles_plus_current_role\") {\n            this.userInheritedRolesPlusCurrentRole = value\n        } else if (key === \"user_permissions\") {\n            this.userPermissions = value\n        } else if (key === \"access_token\") {\n            this.accessToken = value\n        } else if (key === \"expires_at_seconds\") {\n            this.expiresAtSeconds = value\n        } else if (key === \"org_id_to_org_member_info\") {\n            this.orgIdToOrgMemberInfo = value\n        } else if (key === \"user_id\") {\n            this.userId = value\n        } else if (key === \"email_confirmed\") {\n            this.emailConfirmed = value\n        } else if (key === \"first_name\") {\n            this.firstName = value\n        } else if (key === \"last_name\") {\n            this.lastName = value\n        } else if (key === \"picture_url\") {\n            this.pictureUrl = value\n        } else if (key === \"mfa_enabled\") {\n            this.mfaEnabled = value\n        } else if (key === \"has_password\") {\n            this.hasPassword = value\n        } else if (key === \"can_create_orgs\") {\n            this.canCreateOrgs = value\n        } else if (key === \"created_at\") {\n            this.createdAt = value\n        } else if (key === \"last_active_at\") {\n            this.lastActiveAt = value\n        } else if (key === \"legacy_user_id\") {\n            this.legacyUserId = value\n        } else if (key === \"impersonator_user\") {\n            this.impersonatorUserId = value\n        } else if (key === \"org_role_structure\") {\n            this.orgRoleStructure = value\n        } else if (key === \"additional_roles\") {\n            this.userAssignedAdditionalRoles = value\n        } else {\n            return value\n        }\n    })\n}\n\nfunction withExtraArgs(authInfoWithoutExtraArgs: AuthenticationInfo): Promise<AuthenticationInfo> {\n    if (authInfoWithoutExtraArgs.orgIdToOrgMemberInfo) {\n        authInfoWithoutExtraArgs.orgHelper = getOrgHelper(authInfoWithoutExtraArgs.orgIdToOrgMemberInfo)\n        authInfoWithoutExtraArgs.accessHelper = getAccessHelper(authInfoWithoutExtraArgs.orgIdToOrgMemberInfo)\n    }\n    authInfoWithoutExtraArgs.userClass = new UserClass(\n        {\n            userId: authInfoWithoutExtraArgs.user.userId,\n            email: authInfoWithoutExtraArgs.user.email,\n            createdAt: authInfoWithoutExtraArgs.user.createdAt,\n            firstName: authInfoWithoutExtraArgs.user.firstName,\n            lastName: authInfoWithoutExtraArgs.user.lastName,\n            username: authInfoWithoutExtraArgs.user.username,\n            properties: authInfoWithoutExtraArgs.user.properties,\n            pictureUrl: authInfoWithoutExtraArgs.user.pictureUrl,\n            hasPassword: authInfoWithoutExtraArgs.user.hasPassword,\n            hasMfaEnabled: authInfoWithoutExtraArgs.user.mfaEnabled,\n            canCreateOrgs: authInfoWithoutExtraArgs.user.canCreateOrgs,\n            legacyUserId: authInfoWithoutExtraArgs.user.legacyUserId,\n            impersonatorUserId: authInfoWithoutExtraArgs.impersonatorUserId,\n        },\n        convertOrgIdToOrgMemberInfo(authInfoWithoutExtraArgs.orgIdToOrgMemberInfo)\n    )\n    return Promise.resolve(authInfoWithoutExtraArgs)\n}\n\nfunction logCorsError() {\n    console.error(\n        \"Request to PropelAuth failed due to a CORS error. There are a few likely causes: \\n\" +\n            \" 1. In the Frontend Integration section of your dashboard, make sure your requests are coming either the specified Application URL or localhost with a matching port.\\n\" +\n            \" 2. Make sure your server is hosted on HTTPS in production.\"\n    )\n}\n","export const DEFAULT_RETRIES = 3\n\nexport const runWithRetriesOnAnyError = async <T>(fn: () => Promise<T>): Promise<T> => {\n    return runWithRetriesInner(fn, DEFAULT_RETRIES)\n}\n\nconst runWithRetriesInner = async <T>(fn: () => Promise<T>, numRetriesLeft: number): Promise<T> => {\n    try {\n        return await fn()\n    } catch (e) {\n        if (numRetriesLeft <= 0) {\n            throw e\n        }\n        await delay(numRetriesLeftToDelay(numRetriesLeft))\n        return runWithRetriesInner(fn, numRetriesLeft - 1)\n    }\n}\n\nconst delay = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms))\n\nconst numRetriesLeftToDelay = (numRetriesLeft: number) => {\n    // We could be fancy, but we only retry 3 times so...\n    if (numRetriesLeft >= 3) {\n        return 100\n    } else if (numRetriesLeft === 2) {\n        return 200\n    } else {\n        return 300\n    }\n}","export function currentTimeSeconds() {\n    return Date.now() / 1000\n}\n\nexport function hasLocalStorage(): boolean {\n    return typeof localStorage !== \"undefined\"\n}\n\nexport function hasWindow(): boolean {\n    return typeof window !== \"undefined\"\n}\n\nexport function getLocalStorageNumber(key: string): number | null {\n    if (!hasLocalStorage()) {\n        return null\n    }\n\n    const value = localStorage.getItem(key)\n    if (!value) {\n        return null\n    }\n    const num = parseInt(value, 10)\n    if (Number.isNaN(num)) {\n        return null\n    }\n    return num\n}\n","import { AuthenticationInfo, fetchAuthenticationInfo, logout } from \"./api\"\nimport { runWithRetriesOnAnyError } from \"./fetch_retries\"\nimport { currentTimeSeconds, getLocalStorageNumber, hasLocalStorage, hasWindow } from \"./helpers\"\n\nconst LOGGED_IN_AT_KEY = \"__PROPEL_AUTH_LOGGED_IN_AT\"\nconst LOGGED_OUT_AT_KEY = \"__PROPEL_AUTH_LOGGED_OUT_AT\"\nconst AUTH_TOKEN_REFRESH_BEFORE_EXPIRATION_SECONDS = 10 * 60\nconst DEBOUNCE_DURATION_FOR_REFOCUS_SECONDS = 60\nconst ACTIVE_ORG_ACCESS_TOKEN_REFRESH_EXPIRATION_SECONDS = 60 * 5\n\nconst encodeBase64 = (str: string) => {\n    const encode = window ? window.btoa : btoa\n    return encode(str)\n}\n\nexport interface RedirectToSignupOptions {\n    postSignupRedirectUrl?: string\n    userSignupQueryParameters?: Record<string, string>\n}\n\nexport interface RedirectToLoginOptions {\n    postLoginRedirectUrl?: string\n    userSignupQueryParameters?: Record<string, string>\n}\n\nexport interface RedirectToAccountOptions {\n    redirectBackToUrl?: string\n}\n\nexport interface RedirectToCreateOrgOptions {\n    redirectBackToUrl?: string\n}\n\nexport interface RedirectToOrgPageOptions {\n    redirectBackToUrl?: string\n}\n\nexport interface RedirectToSetupSAMLPageOptions {\n    redirectBackToUrl?: string\n}\n\nexport type AccessTokenForActiveOrg =\n    | {\n          error: undefined\n          accessToken: string\n      }\n    | {\n          error: \"user_not_in_org\"\n          accessToken: never\n      }\n    | {\n          error: \"unexpected_error\"\n          accessToken: never\n      }\n\nexport interface IAuthClient {\n    /**\n     * If the user is logged in, this method returns an access token, the time (in seconds) that the token will expire,\n     * the user's organizations (including org names and user's role within the org), and the user's metadata.\n     * Otherwise, this method returns null.\n     *\n     * The promise will generally resolve immediately, unless our current information is stale in which case it will\n     * make an API request.\n     *\n     * @param forceRefresh If true, this method will always make an API request. Default false\n     */\n    getAuthenticationInfoOrNull(forceRefresh?: boolean): Promise<AuthenticationInfo | null>\n\n    /**\n     * Logs the current user out.\n     * @param redirectAfterLogout If true, will redirect the user to the configured logout URL.\n     */\n    logout(redirectAfterLogout: boolean): Promise<void>\n\n    /**\n     * Gets the URL for the hosted signup page.\n     */\n    getSignupPageUrl(options?: RedirectToSignupOptions): string\n\n    /**\n     * Gets the URL for the hosted login page.\n     */\n    getLoginPageUrl(options?: RedirectToLoginOptions): string\n\n    /**\n     * Gets the URL for the hosted account page.\n     */\n    getAccountPageUrl(options?: RedirectToAccountOptions): string\n\n    /**\n     * Gets the URL for the hosted organization page.\n     * @param orgId The ID of the organization's page to load. If not specified, a random one will be used instead.\n     */\n    getOrgPageUrl(orgId?: string, options?: RedirectToOrgPageOptions): string\n\n    /**\n     * Gets the URL for the hosted create organization page.\n     */\n    getCreateOrgPageUrl(options?: RedirectToCreateOrgOptions): string\n\n    /**\n     * Gets the URL for the hosted SAML configuration page.\n     */\n    getSetupSAMLPageUrl(orgId: string): string\n\n    /**\n     * Gets an access token for a specific organization, known as an Active Org.\n     */\n    getAccessTokenForOrg(orgId: string): Promise<AccessTokenForActiveOrg>\n\n    /**\n     * Redirects the user to the signup page.\n     */\n    redirectToSignupPage(options?: RedirectToSignupOptions): void\n\n    /**\n     * Redirects the user to the login page.\n     */\n    redirectToLoginPage(options?: RedirectToLoginOptions): void\n\n    /**\n     * Redirects the user to the account page.\n     */\n    redirectToAccountPage(options?: RedirectToAccountOptions): void\n\n    /**\n     * Redirects the user to the organization page.\n     * @param orgId The ID of the organization\"s page to load. If not specified, a random one will be used instead.\n     */\n    redirectToOrgPage(orgId?: string, options?: RedirectToOrgPageOptions): void\n\n    /**\n     * Redirects the user to the create organization page.\n     */\n    redirectToCreateOrgPage(options?: RedirectToCreateOrgOptions): void\n\n    /**\n     * Redirects the user to the SAML configuration page.\n     */\n    redirectToSetupSAMLPage(orgId: string, options?: RedirectToSetupSAMLPageOptions): void\n\n    /**\n     * Adds an observer which is called whenever the users logs in or logs out.\n     */\n    addLoggedInChangeObserver(observer: (isLoggedIn: boolean) => void): void\n\n    /**\n     * Removes the observer\n     */\n    removeLoggedInChangeObserver(observer: (isLoggedIn: boolean) => void): void\n\n    /**\n     * Adds an observer which is called whenever the access token changes.\n     */\n    addAccessTokenChangeObserver(observer: (accessToken: string | undefined) => void): void\n\n    /**\n     * Removes the observer\n     */\n    removeAccessTokenChangeObserver(observer: (accessToken: string | undefined) => void): void\n\n    /**\n     * Cleanup the auth client if you no longer need it.\n     */\n    destroy(): void\n}\n\nexport interface IAuthOptions {\n    /**\n     * Base URL where your authentication pages are hosted. See **Frontend Integration** section of your PropelAuth project.\n     */\n    authUrl: string\n\n    /**\n     * If true, periodically refresh the token in the background.\n     * This helps ensure you always have a valid token ready to go when you need it.\n     *\n     * Default true\n     */\n    enableBackgroundTokenRefresh?: boolean\n}\n\ninterface AccessTokenActiveOrgMap {\n    [orgId: string]: {\n        accessToken: string\n        fetchedAt: number\n    }\n}\n\ninterface ClientState {\n    initialLoadFinished: boolean\n    authenticationInfo: AuthenticationInfo | null\n    observers: ((isLoggedIn: boolean) => void)[]\n    accessTokenObservers: ((accessToken: string | undefined) => void)[]\n    lastLoggedInAtMessage: number | null\n    lastLoggedOutAtMessage: number | null\n    refreshInterval: number | null\n    lastRefresh: number | null\n    accessTokenActiveOrgMap: AccessTokenActiveOrgMap\n    readonly authUrl: string\n}\n\nfunction validateAndCleanupOptions(authOptions: IAuthOptions) {\n    try {\n        // This helps make sure we have a consistent URL ignoring things like trailing slashes\n        const authUrl = new URL(authOptions.authUrl)\n        authOptions.authUrl = authUrl.origin\n    } catch (e) {\n        console.error(\"Invalid authUrl\", e)\n        throw new Error(\"Unable to initialize auth client\")\n    }\n\n    if (authOptions.enableBackgroundTokenRefresh === undefined) {\n        authOptions.enableBackgroundTokenRefresh = true\n    }\n}\n\nexport function createClient(authOptions: IAuthOptions): IAuthClient {\n    validateAndCleanupOptions(authOptions)\n\n    // Internal state\n    const clientState: ClientState = {\n        initialLoadFinished: false,\n        authenticationInfo: null,\n        observers: [],\n        accessTokenObservers: [],\n        lastLoggedInAtMessage: getLocalStorageNumber(LOGGED_IN_AT_KEY),\n        lastLoggedOutAtMessage: getLocalStorageNumber(LOGGED_OUT_AT_KEY),\n        authUrl: authOptions.authUrl,\n        refreshInterval: null,\n        lastRefresh: null,\n        accessTokenActiveOrgMap: {},\n    }\n\n    // Helper functions\n    function notifyObservers(isLoggedIn: boolean) {\n        for (let i = 0; i < clientState.observers.length; i++) {\n            const observer = clientState.observers[i]\n            if (observer) {\n                observer(isLoggedIn)\n            }\n        }\n    }\n\n    function notifyObserversOfAccessTokenChange(accessToken: string | undefined) {\n        for (let i = 0; i < clientState.accessTokenObservers.length; i++) {\n            const observer = clientState.accessTokenObservers[i]\n            if (observer) {\n                observer(accessToken)\n            }\n        }\n    }\n\n    function userJustLoggedOut(accessToken: string | undefined, previousAccessToken: string | undefined) {\n        // Edge case: the first time we go to the page, if we can't load the\n        //   auth token we should treat it as a logout event\n        return !accessToken && (previousAccessToken || !clientState.initialLoadFinished)\n    }\n\n    function userJustLoggedIn(accessToken: string | undefined, previousAccessToken: string | undefined) {\n        return !previousAccessToken && accessToken\n    }\n\n    function updateLastLoggedOutAt() {\n        const loggedOutAt = currentTimeSeconds()\n        clientState.lastLoggedOutAtMessage = loggedOutAt\n        if (hasLocalStorage()) {\n            localStorage.setItem(LOGGED_OUT_AT_KEY, String(loggedOutAt))\n        }\n    }\n\n    function updateLastLoggedInAt() {\n        const loggedInAt = currentTimeSeconds()\n        clientState.lastLoggedInAtMessage = loggedInAt\n        if (hasLocalStorage()) {\n            localStorage.setItem(LOGGED_IN_AT_KEY, String(loggedInAt))\n        }\n    }\n\n    /**\n     * Invalidates all org's access tokens.\n     */\n    function resetAccessTokenActiveOrgMap() {\n        clientState.accessTokenActiveOrgMap = {}\n    }\n\n    function setAuthenticationInfoAndUpdateDownstream(authenticationInfo: AuthenticationInfo | null) {\n        const previousAccessToken = clientState.authenticationInfo?.accessToken\n        clientState.authenticationInfo = authenticationInfo\n        const accessToken = authenticationInfo?.accessToken\n\n        if (userJustLoggedOut(accessToken, previousAccessToken)) {\n            notifyObservers(false)\n            updateLastLoggedOutAt()\n        } else if (userJustLoggedIn(accessToken, previousAccessToken)) {\n            notifyObservers(true)\n            updateLastLoggedInAt()\n        }\n\n        if (previousAccessToken !== accessToken) {\n            notifyObserversOfAccessTokenChange(accessToken)\n        }\n\n        resetAccessTokenActiveOrgMap()\n\n        clientState.lastRefresh = currentTimeSeconds()\n        clientState.initialLoadFinished = true\n    }\n\n    async function forceRefreshToken(returnCached: boolean): Promise<AuthenticationInfo | null> {\n        try {\n            // Happy case, we fetch auth info and save it\n            const authenticationInfo = await runWithRetriesOnAnyError(() =>\n                fetchAuthenticationInfo(clientState.authUrl)\n            )\n            setAuthenticationInfoAndUpdateDownstream(authenticationInfo)\n            return authenticationInfo\n        } catch (e) {\n            // If there was an error, we sometimes still want to return the value we have cached\n            //   (e.g. if we were prefetching), so in those cases we swallow the exception\n            if (returnCached) {\n                return clientState.authenticationInfo\n            } else {\n                setAuthenticationInfoAndUpdateDownstream(null)\n                throw e\n            }\n        }\n    }\n\n    const getSignupPageUrl = (options?: RedirectToSignupOptions) => {\n        let qs = new URLSearchParams()\n        let url = `${clientState.authUrl}/signup`\n        if (options) {\n            const { postSignupRedirectUrl, userSignupQueryParameters } = options\n            if (postSignupRedirectUrl) {\n                qs.set(\"rt\", encodeBase64(postSignupRedirectUrl))\n            }\n            if (userSignupQueryParameters) {\n                Object.entries(userSignupQueryParameters).forEach(([key, value]) => {\n                    qs.set(key, value)\n                })\n            }\n        }\n        if (qs.toString()) {\n            url += `?${qs.toString()}`\n        }\n        return url\n    }\n\n    const getLoginPageUrl = (options?: RedirectToLoginOptions) => {\n        let qs = new URLSearchParams()\n        let url = `${clientState.authUrl}/login`\n        if (options) {\n            const { postLoginRedirectUrl, userSignupQueryParameters } = options\n            if (postLoginRedirectUrl) {\n                qs.set(\"rt\", encodeBase64(postLoginRedirectUrl))\n            }\n            if (userSignupQueryParameters) {\n                Object.entries(userSignupQueryParameters).forEach(([key, value]) => {\n                    qs.set(key, value)\n                })\n            }\n        }\n        if (qs.toString()) {\n            url += `?${qs.toString()}`\n        }\n        return url\n    }\n\n    const getAccountPageUrl = (options?: RedirectToAccountOptions) => {\n        let qs = new URLSearchParams()\n        let url = `${clientState.authUrl}/account`\n        if (options) {\n            const { redirectBackToUrl } = options\n            if (redirectBackToUrl) {\n                qs.set(\"rt\", encodeBase64(redirectBackToUrl))\n            }\n        }\n\n        if (qs.toString()) {\n            url += `?${qs.toString()}`\n        }\n        return url\n    }\n\n    const getOrgPageUrl = (orgId?: string, options?: RedirectToOrgPageOptions) => {\n        let qs = new URLSearchParams()\n        let url = `${clientState.authUrl}/org`\n        if (orgId) {\n            qs.set(\"id\", orgId)\n        }\n\n        if (options) {\n            if (options.redirectBackToUrl) {\n                qs.set(\"rt\", encodeBase64(options.redirectBackToUrl))\n            }\n        }\n\n        if (qs.toString()) {\n            url += `?${qs.toString()}`\n        }\n        return url\n    }\n\n    const getCreateOrgPageUrl = (options?: RedirectToCreateOrgOptions) => {\n        let qs = new URLSearchParams()\n        let url = `${clientState.authUrl}/create_org`\n        if (options) {\n            const { redirectBackToUrl } = options\n            if (redirectBackToUrl) {\n                qs.set(\"rt\", encodeBase64(redirectBackToUrl))\n            }\n        }\n        if (qs.toString()) {\n            url += `?${qs.toString()}`\n        }\n        return url\n    }\n\n    const getSetupSAMLPageUrl = (orgId: string, options?: RedirectToSetupSAMLPageOptions) => {\n        let qs = new URLSearchParams()\n        if (options) {\n            if (options.redirectBackToUrl) {\n                qs.set(\"rt\", encodeBase64(options.redirectBackToUrl))\n            }\n        }\n        qs.set(\"id\", orgId)\n\n        return `${clientState.authUrl}/saml?${qs.toString()}`\n    }\n\n    const client = {\n        addLoggedInChangeObserver(loggedInChangeObserver: (isLoggedIn: boolean) => void): void {\n            const hasObserver = clientState.observers.includes(loggedInChangeObserver)\n            if (hasObserver) {\n                console.error(\"Observer has been attached already.\")\n            } else if (!loggedInChangeObserver) {\n                console.error(\"Cannot add a null observer\")\n            } else {\n                clientState.observers.push(loggedInChangeObserver)\n            }\n        },\n\n        removeLoggedInChangeObserver(loggedInChangeObserver: (isLoggedIn: boolean) => void): void {\n            const observerIndex = clientState.observers.indexOf(loggedInChangeObserver)\n            if (observerIndex === -1) {\n                console.error(\"Cannot find observer to remove\")\n            } else {\n                clientState.observers.splice(observerIndex, 1)\n            }\n        },\n\n        addAccessTokenChangeObserver(observer: (accessToken: string | undefined) => void) {\n            const hasObserver = clientState.accessTokenObservers.includes(observer)\n            if (hasObserver) {\n                console.error(\"Observer has been attached already.\")\n            } else if (!observer) {\n                console.error(\"Cannot add a null observer\")\n            } else {\n                clientState.accessTokenObservers.push(observer)\n            }\n        },\n\n        removeAccessTokenChangeObserver(observer: (accessToken: string | undefined) => void) {\n            const observerIndex = clientState.accessTokenObservers.indexOf(observer)\n            if (observerIndex === -1) {\n                console.error(\"Cannot find observer to remove\")\n            } else {\n                clientState.accessTokenObservers.splice(observerIndex, 1)\n            }\n        },\n\n        async getAuthenticationInfoOrNull(forceRefresh?: boolean): Promise<AuthenticationInfo | null> {\n            const currentTimeSecs = currentTimeSeconds()\n            if (forceRefresh) {\n                return await forceRefreshToken(false)\n            } else if (!clientState.authenticationInfo) {\n                return await forceRefreshToken(false)\n            } else if (\n                currentTimeSecs + AUTH_TOKEN_REFRESH_BEFORE_EXPIRATION_SECONDS >\n                clientState.authenticationInfo.expiresAtSeconds\n            ) {\n                // Small edge case: If we were being proactive\n                //   and the auth information hasn't expired yet, swallow any exceptions\n                const returnCached = currentTimeSecs < clientState.authenticationInfo.expiresAtSeconds\n                return await forceRefreshToken(returnCached)\n            } else {\n                return clientState.authenticationInfo\n            }\n        },\n\n        async getAccessTokenForOrg(orgId: string): Promise<AccessTokenForActiveOrg> {\n            // First, check if there is a valid access token for the org ID in the\n            // valid time frame.\n            const currentTimeSecs = currentTimeSeconds()\n\n            const activeOrgAccessToken = clientState.accessTokenActiveOrgMap[orgId]\n            if (!!activeOrgAccessToken) {\n                if (\n                    currentTimeSecs <\n                    activeOrgAccessToken.fetchedAt + ACTIVE_ORG_ACCESS_TOKEN_REFRESH_EXPIRATION_SECONDS\n                ) {\n                    return {\n                        accessToken: activeOrgAccessToken.accessToken,\n                        error: undefined,\n                    }\n                }\n            }\n            // Fetch the access token for the org ID and update.\n            try {\n                const authenticationInfo = await runWithRetriesOnAnyError(() =>\n                    fetchAuthenticationInfo(clientState.authUrl, orgId)\n                )\n                if (!authenticationInfo) {\n                    // Only null if 401 unauthorized.\n                    return {\n                        error: \"user_not_in_org\",\n                        accessToken: null as never,\n                    }\n                }\n                const { accessToken } = authenticationInfo\n                clientState.accessTokenActiveOrgMap[orgId] = {\n                    accessToken,\n                    fetchedAt: currentTimeSecs,\n                }\n                return {\n                    accessToken,\n                    error: undefined,\n                }\n            } catch (e) {\n                return {\n                    error: \"unexpected_error\",\n                    accessToken: null as never,\n                }\n            }\n        },\n\n        getSignupPageUrl(options?: RedirectToSignupOptions): string {\n            return getSignupPageUrl(options)\n        },\n\n        getLoginPageUrl(options?: RedirectToLoginOptions): string {\n            return getLoginPageUrl(options)\n        },\n\n        getAccountPageUrl(options?: RedirectToAccountOptions): string {\n            return getAccountPageUrl(options)\n        },\n\n        getOrgPageUrl(orgId?: string, options?: RedirectToOrgPageOptions): string {\n            return getOrgPageUrl(orgId, options)\n        },\n\n        getCreateOrgPageUrl(options?: RedirectToCreateOrgOptions): string {\n            return getCreateOrgPageUrl(options)\n        },\n\n        getSetupSAMLPageUrl(orgId: string, options?: RedirectToSetupSAMLPageOptions): string {\n            return getSetupSAMLPageUrl(orgId, options)\n        },\n\n        redirectToSignupPage(options?: RedirectToSignupOptions): void {\n            window.location.href = getSignupPageUrl(options)\n        },\n\n        redirectToLoginPage(options?: RedirectToLoginOptions): void {\n            window.location.href = getLoginPageUrl(options)\n        },\n\n        redirectToAccountPage(options?: RedirectToAccountOptions): void {\n            window.location.href = getAccountPageUrl(options)\n        },\n\n        redirectToOrgPage(orgId?: string, options?: RedirectToOrgPageOptions): void {\n            window.location.href = getOrgPageUrl(orgId, options)\n        },\n\n        redirectToCreateOrgPage(options?: RedirectToCreateOrgOptions): void {\n            window.location.href = getCreateOrgPageUrl(options)\n        },\n\n        redirectToSetupSAMLPage(orgId: string, options?: RedirectToSetupSAMLPageOptions) {\n            window.location.href = getSetupSAMLPageUrl(orgId, options)\n        },\n\n        async logout(redirectAfterLogout: boolean): Promise<void> {\n            const logoutResponse = await logout(clientState.authUrl)\n            setAuthenticationInfoAndUpdateDownstream(null)\n            if (redirectAfterLogout) {\n                window.location.href = logoutResponse.redirect_to\n            }\n        },\n\n        destroy() {\n            clientState.observers = []\n            clientState.accessTokenObservers = []\n            window.removeEventListener(\"storage\", onStorageChange)\n            if (clientState.refreshInterval) {\n                clearInterval(clientState.refreshInterval)\n            }\n        },\n    }\n\n    const onStorageChange = async function () {\n        // If localStorage isn't available, nothing to do here.\n        // This usually happens in frameworks that have some SSR components\n        if (!hasLocalStorage()) {\n            return\n        }\n\n        const loggedOutAt = getLocalStorageNumber(LOGGED_OUT_AT_KEY)\n        const loggedInAt = getLocalStorageNumber(LOGGED_IN_AT_KEY)\n\n        // If we've detected a logout event after the last one our client is aware of, trigger a refresh\n        if (loggedOutAt && (!clientState.lastLoggedOutAtMessage || loggedOutAt > clientState.lastLoggedOutAtMessage)) {\n            clientState.lastLoggedOutAtMessage = loggedOutAt\n            if (clientState.authenticationInfo) {\n                await forceRefreshToken(true)\n            }\n        }\n\n        // If we've detected a login event after the last one our client is aware of, trigger a refresh\n        if (loggedInAt && (!clientState.lastLoggedInAtMessage || loggedInAt > clientState.lastLoggedInAtMessage)) {\n            clientState.lastLoggedInAtMessage = loggedInAt\n            if (!clientState.authenticationInfo) {\n                await forceRefreshToken(true)\n            }\n        }\n    }\n\n    // If we were offline or on a different tab, when we return, refetch auth info\n    // Some browsers trigger focus more often than we'd like, so we'll debounce a little here as well\n    const onOnlineOrFocus = async function () {\n        if (\n            clientState.lastRefresh &&\n            currentTimeSeconds() > clientState.lastRefresh + DEBOUNCE_DURATION_FOR_REFOCUS_SECONDS\n        ) {\n            await forceRefreshToken(true)\n        } else {\n            await client.getAuthenticationInfoOrNull()\n        }\n    }\n\n    if (hasWindow()) {\n        window.addEventListener(\"storage\", onStorageChange)\n        window.addEventListener(\"online\", onOnlineOrFocus)\n        window.addEventListener(\"focus\", onOnlineOrFocus)\n\n        if (authOptions.enableBackgroundTokenRefresh) {\n            client.getAuthenticationInfoOrNull()\n            clientState.refreshInterval = window.setInterval(client.getAuthenticationInfoOrNull, 60000)\n        }\n    }\n\n    return client\n}\n"],"names":["ACTIVE_ORG_ID_COOKIE_NAME","OrgRoleStructure","setActiveOrgId","orgId","Cookies","set","sameSite","secure","getActiveOrgId","get","getAccessHelper","orgIdToOrgMemberInfo","isRole","role","orgMemberInfo","undefined","orgRoleStructure","MultiRole","userAssignedRole","userAssignedAdditionalRoles","includes","isAtLeastRole","userInheritedRolesPlusCurrentRole","hasPermission","permission","userPermissions","hasAllPermissions","permissions","every","getAccessHelperWithOrgId","getOrgHelper","getOrg","hasOwnProperty","getOrgIds","Object","keys","getOrgs","values","getOrgByName","orgName","urlSafeOrgName","UserClass","constructor","userFields","orgIdToUserOrgInfo","userId","email","firstName","lastName","username","createdAt","pictureUrl","hasPassword","hasMfaEnabled","canCreateOrgs","legacyUserId","impersonatorUserId","properties","toLowerCase","replace","getUserProperty","key","isImpersonating","fromJSON","json","obj","JSON","parse","OrgMemberInfoClass","stringify","e","console","error","orgMetadata","SingleRole","convertOrgIdToOrgMemberInfo","fetchAuthenticationInfo","authUrl","activeOrgId","queryParams","URLSearchParams","append","path","toString","fetch","method","credentials","headers","then","res","status","logCorsError","Promise","reject","message","ok","statusText","parseResponse","logout","text","httpResponse","authInfoWithoutUserClass","parseJsonConvertingSnakeToCamel","withExtraArgs","str","value","accessToken","expiresAtSeconds","emailConfirmed","mfaEnabled","lastActiveAt","authInfoWithoutExtraArgs","orgHelper","accessHelper","userClass","user","resolve","DEFAULT_RETRIES","runWithRetriesOnAnyError","fn","runWithRetriesInner","numRetriesLeft","delay","numRetriesLeftToDelay","ms","setTimeout","currentTimeSeconds","Date","now","hasLocalStorage","localStorage","hasWindow","window","getLocalStorageNumber","getItem","num","parseInt","Number","isNaN","LOGGED_IN_AT_KEY","LOGGED_OUT_AT_KEY","AUTH_TOKEN_REFRESH_BEFORE_EXPIRATION_SECONDS","DEBOUNCE_DURATION_FOR_REFOCUS_SECONDS","ACTIVE_ORG_ACCESS_TOKEN_REFRESH_EXPIRATION_SECONDS","encodeBase64","encode","btoa","validateAndCleanupOptions","authOptions","URL","origin","Error","enableBackgroundTokenRefresh","createClient","clientState","initialLoadFinished","authenticationInfo","observers","accessTokenObservers","lastLoggedInAtMessage","lastLoggedOutAtMessage","refreshInterval","lastRefresh","accessTokenActiveOrgMap","notifyObservers","isLoggedIn","i","length","observer","notifyObserversOfAccessTokenChange","userJustLoggedOut","previousAccessToken","userJustLoggedIn","updateLastLoggedOutAt","loggedOutAt","setItem","String","updateLastLoggedInAt","loggedInAt","resetAccessTokenActiveOrgMap","setAuthenticationInfoAndUpdateDownstream","_clientState$authenti","forceRefreshToken","returnCached","getSignupPageUrl","options","qs","url","postSignupRedirectUrl","userSignupQueryParameters","entries","forEach","getLoginPageUrl","postLoginRedirectUrl","getAccountPageUrl","redirectBackToUrl","getOrgPageUrl","getCreateOrgPageUrl","getSetupSAMLPageUrl","client","addLoggedInChangeObserver","loggedInChangeObserver","hasObserver","push","removeLoggedInChangeObserver","observerIndex","indexOf","splice","addAccessTokenChangeObserver","removeAccessTokenChangeObserver","getAuthenticationInfoOrNull","forceRefresh","currentTimeSecs","getAccessTokenForOrg","activeOrgAccessToken","fetchedAt","redirectToSignupPage","location","href","redirectToLoginPage","redirectToAccountPage","redirectToOrgPage","redirectToCreateOrgPage","redirectToSetupSAMLPage","redirectAfterLogout","logoutResponse","redirect_to","destroy","removeEventListener","onStorageChange","clearInterval","onOnlineOrFocus","addEventListener","setInterval"],"mappings":"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"}